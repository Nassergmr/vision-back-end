generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id                      String     @id @default(auto()) @map("_id") @db.ObjectId
  firstName               String?
  lastName                String?
  email                   String?    @unique
  password                String?
  avatar                  String     @default("https://res.cloudinary.com/dae5vlvpe/image/upload/v1753372351/avatar_e0wegn.png")
  images                  Image[]    @relation("userImages")
  likes                   Like[]     @relation("userLikes")
  favorites               Favorite[] @relation("userFavorites")
  createdAt               DateTime   @default(now())
  updatedAt               DateTime   @updatedAt
  isVerified              Boolean    @default(false)
  verificationToken       String?
  verificationTokenExpiry DateTime?
}

model Image {
  id        String     @id @default(auto()) @map("_id") @db.ObjectId
  imageBy   User       @relation(fields: [userId], references: [id], name: "userImages")
  userId    String     @db.ObjectId
  likes     Like[]     @relation("imageLike")
  favorites Favorite[] @relation("imagefavorites")
  url       String
  published Boolean    @default(false)
  addedAt   DateTime   @default(now())
}

model Like {
  id         String @id @default(auto()) @map("_id") @db.ObjectId
  user       User   @relation(fields: [userId], references: [id], name: "userLikes")
  userId     String @db.ObjectId
  imageLikes Image  @relation(fields: [imageId], references: [id], name: "imageLike")
  imageId    String @db.ObjectId

  @@unique([userId, imageId])
}

model Favorite {
  id            String @id @default(auto()) @map("_id") @db.ObjectId
  favoratedBy   User   @relation(fields: [userId], references: [id], name: "userFavorites")
  userId        String @db.ObjectId
  imageFavorite Image  @relation(fields: [imageId], references: [id], name: "imagefavorites")
  imageId       String @db.ObjectId

  @@unique([userId, imageId])
}
